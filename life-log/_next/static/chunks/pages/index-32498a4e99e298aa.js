(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(3678)}])},3678:function(e,t,n){"use strict";n.r(t);var s=n(4111),i=n(1438),a=n(2951),l=n(4924),o=n(8029),c=n(460),r=n(5893),d=n(7294),m=(n(8074),n(9483)),u=n.n(m),h=function(e){(0,o.Z)(n,e);var t=(0,c.Z)(n);function n(){var e;return(0,i.Z)(this,n),e=t.call(this),(0,l.Z)((0,s.Z)(e),"refreshList",(function(){var t=[],n=(0,s.Z)(e);u().iterate((function(e,n,s){t.push(e)})).then((function(){console.log("Iteration has completed");var e=t.sort((function(e,t){var n=new Date(e.timestamp).getTime();return new Date(t.timestamp).getTime()-n}));n.setState({items:e})})).catch((function(e){console.log(e)}))})),(0,l.Z)((0,s.Z)(e),"handleListFilterChange",(function(t){e.refreshList();var n=t.target.value;console.log("inputVal = ".concat(n));var i=e.state.items.filter((function(e){var t=JSON.stringify(e).toLowerCase();if(console.log(t),t.indexOf(n.toLowerCase())>-1)return e}));if(i.length>0){var a=(0,s.Z)(e);setTimeout((function(){a.setState({items:i}),a.setState({filterText:n})}),1e3)}})),(0,l.Z)((0,s.Z)(e),"handleItemClick",(function(t){e.showItemDetails(t),f=t})),(0,l.Z)((0,s.Z)(e),"handleDeleteItemClick",(function(t){var n;t.preventDefault(),n=f,u().removeItem(n).then((function(){console.log("".concat(JSON.stringify(n)," deleted!")),x()})).catch((function(e){console.log(e)})),e.refreshList()})),(0,l.Z)((0,s.Z)(e),"handleFormSubmit",(function(t){t.preventDefault();var n=new Date,s={timestamp:n.toISOString(),description:e.state.description};!function(e,t){console.log("adding ".concat(JSON.stringify(t))),u().setItem(e,t).then((function(){return u().getItem("key")})).then((function(e){g("list-entries")})).catch((function(e){alert("adding item failed")}))}(n.getTime().toString(),s);var i=e.state.items.concat(s).sort((function(e,t){var n=new Date(e.timestamp).getTime();return new Date(t.timestamp).getTime()-n}));e.setState({items:i})})),e.state={items:[],description:""},e.handleSearchButtonSubmit=e.handleSearchButtonSubmit.bind((0,s.Z)(e)),e.input=d.createRef(),e}return(0,a.Z)(n,[{key:"componentDidMount",value:function(){this.refreshList()}},{key:"handleFormChange",value:function(e,t){console.log(e,t.target.value),this.setState((0,l.Z)({},e,t.target.value))}},{key:"handleSearchButtonSubmit",value:function(e){var t=[],n=this,s=this.input.current.value;console.log("inputVal = ".concat(s)),u().iterate((function(e,n,i){JSON.stringify(e).toLowerCase().indexOf(s.toLowerCase())>-1&&t.push(e)})).then((function(){console.log("Iteration has completed");var e=t.sort((function(e,t){var n=new Date(e.timestamp).getTime();return new Date(t.timestamp).getTime()-n}));n.setState({items:e}),n.setState({filterText:s})})).catch((function(e){console.log(e)}))}},{key:"showItemDetails",value:function(e){var t=new Date(e.timestamp).getTime().toString();u().getItem(t).then((function(n){var s=n.description;document.getElementById("currentItemDesc").value=s;var i="".concat(new Date(e.timestamp).toLocaleString()," - ").concat(s);document.getElementById("currentItemSummary").innerHTML=i,f=t,document.getElementById("item-modal").classList.add("is-active")})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this;return(0,r.jsxs)("div",{className:"App",children:[(0,r.jsxs)("section",{className:"section",children:[(0,r.jsx)("div",{className:"content",children:(0,r.jsx)("h3",{className:"has-text-centered",children:"Life Log Next"})}),(0,r.jsx)("div",{className:"tabs is-centered",children:(0,r.jsxs)("ul",{children:[(0,r.jsx)("li",{id:"enter-data-list-item",className:"is-active",children:(0,r.jsx)("a",{onClick:function(e){return g("enter-data")},children:"Enter"})}),(0,r.jsx)("li",{id:"list-entries-list-item",children:(0,r.jsx)("a",{onClick:function(e){return g("list-entries")},children:"List"})})]})}),(0,r.jsx)("div",{id:"enter-data",className:"column",children:(0,r.jsx)("form",{onSubmit:this.handleFormSubmit,children:(0,r.jsxs)("div",{className:"columns is-gapless",children:[(0,r.jsx)("div",{className:"column"}),(0,r.jsxs)("div",{className:"column",children:[(0,r.jsxs)("div",{className:"field",children:[(0,r.jsx)("label",{className:"label",children:"Log stuff here:"}),(0,r.jsxs)("div",{className:"control has-icons-left",children:[(0,r.jsx)("textarea",{className:"textarea",type:"text",placeholder:"Put anything to describe what life event you want to track",defaultValue:"",onChange:this.handleFormChange.bind(this,"description")}),(0,r.jsx)("span",{className:"icon is-small is-left",children:(0,r.jsx)("i",{className:"fas fa-asterisk"})})]})]}),(0,r.jsxs)("div",{className:"field is-grouped",children:[(0,r.jsx)("p",{className:"control",children:(0,r.jsx)("a",{type:"submit",onClick:this.handleFormSubmit,className:"button is-success",children:"Add"})}),(0,r.jsx)("p",{className:"control",children:(0,r.jsx)("a",{className:"button is-danger",children:"Clear"})})]})]}),(0,r.jsx)("div",{className:"column"})]})})}),(0,r.jsxs)("div",{id:"list-entries",className:"column",style:{display:"none"},children:[(0,r.jsx)("form",{onSubmit:this.handleSearchButtonSubmit,children:(0,r.jsxs)("div",{className:"field has-addons",children:[(0,r.jsx)("div",{className:"control is-expanded",children:(0,r.jsx)("input",{className:"input",type:"text",placeholder:"Start typing here to filter",defaultValue:"",ref:this.input})}),(0,r.jsx)("div",{className:"control",children:(0,r.jsx)("a",{className:"button is-info",onClick:this.handleSearchButtonSubmit,children:"Search"})})]})}),(0,r.jsxs)("table",{id:"entry-items",className:"table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Date"}),(0,r.jsx)("th",{children:"Description"})]})}),(0,r.jsx)("tbody",{children:this.state.items&&this.state.items.map((function(t){return(0,r.jsxs)("tr",{onClick:function(n){return e.handleItemClick(t,n)},children:[(0,r.jsx)("td",{children:new Date(t.timestamp).toLocaleString()}),(0,r.jsx)("td",{children:t.description})]},new Date(t.timestamp).getTime())}))})]}),(0,r.jsxs)("div",{className:"field is-grouped",children:[(0,r.jsx)("p",{className:"control",children:(0,r.jsx)("button",{onClick:v,className:"button is-info",children:"Download Data"})}),(0,r.jsxs)("p",{className:"control",children:[(0,r.jsx)("input",{type:"file",id:"importFile",style:{display:"none"},onChange:j}),(0,r.jsx)("button",{className:"button is-success",children:(0,r.jsx)("label",{htmlFor:"importFile",children:"Import Data"})})]})]})]})]}),(0,r.jsxs)("div",{id:"item-modal",className:"modal",children:[(0,r.jsx)("div",{className:"modal-background"}),(0,r.jsxs)("div",{className:"modal-card",children:[(0,r.jsxs)("header",{className:"modal-card-head",children:[(0,r.jsx)("p",{className:"modal-card-title",children:"Item Details"}),(0,r.jsx)("button",{className:"delete","aria-label":"close",onClick:x})]}),(0,r.jsxs)("section",{className:"modal-card-body",children:[(0,r.jsx)("table",{className:"table",children:(0,r.jsx)("tbody",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:"Life Event:"}),(0,r.jsx)("td",{children:(0,r.jsx)("textarea",{id:"currentItemDesc",className:"textarea",type:"text"})})]})})}),(0,r.jsx)("div",{id:"currentItemSummary"})]}),(0,r.jsxs)("footer",{className:"modal-card-foot",children:[(0,r.jsx)("button",{className:"button is-success",children:"Save"}),(0,r.jsx)("button",{onClick:this.handleDeleteItemClick,className:"button is-danger",children:"Delete"}),(0,r.jsx)("button",{onClick:p,className:"button is-info",children:"Share"})]})]})]})]})}}]),n}(d.Component),f="";function g(e){"enter-data"===e?(document.getElementById("enter-data").style.display="block",document.getElementById("list-entries").style.display="none",document.getElementById("enter-data-list-item").classList.add("is-active"),document.getElementById("list-entries-list-item").classList.remove("is-active")):"list-entries"===e&&(document.getElementById("enter-data").style.display="none",document.getElementById("list-entries").style.display="block",document.getElementById("enter-data-list-item").classList.remove("is-active"),document.getElementById("list-entries-list-item").classList.add("is-active")),document.getElementById(e).style.display="block"}function x(){f="",document.getElementById("item-modal").classList.remove("is-active")}function p(){console.log("Share button clicked! Let's see if anything else happens.");var e=document.getElementById("currentItemSummary").innerHTML||"Sorry, your browser and/or phone doesn't allow sharing.";navigator.share?(console.log("Share is allowed. Yay! Will now try to share ".concat(e)),navigator.share({title:"Life Log Item",text:e}).then((function(){console.log("Successful share")})).catch((function(e){alert("Error sharing",e)}))):alert("Sorry, this only works on Android Chrome.")}function v(){console.log("Export button clicked! Let's see if anything else happens.");var e=[];u().iterate((function(t,n,s){e.push(t)})).then((function(){console.log("Iteration has completed");var t=JSON.stringify(e);console.log("downloading as json = ".concat(t));var n="data:text/json;charset=utf-8,"+encodeURIComponent(t),s=document.createElement("a");s.setAttribute("href",n),s.setAttribute("download","life-log-backup.json"),s.click(),s.remove()})).catch((function(e){console.log(e)}))}function j(){var e=document.getElementById("importFile").files[0],t=new FileReader;t.readAsText(e),t.onload=function(e){for(var t=function(){var e=n[s],t=new Date(e.timestamp).getTime().toString();u().setItem(t,e).then((function(){return u().getItem("key")})).then((function(t){console.log("".concat(JSON.stringify(e),"\n"))})).catch((function(e){alert("adding item failed")}))},n=JSON.parse(e.target.result),s=0,i=n.length;s<i;s++)t();alert("Importing data done!")}}u().config({driver:u().INDEXEDDB,name:"life-log",version:1,size:4980736,storeName:"life_log",description:"life log"}),t.default=h}},function(e){e.O(0,[774,99,861,888,179],(function(){return t=5557,e(e.s=t);var t}));var t=e.O();_N_E=t}]);