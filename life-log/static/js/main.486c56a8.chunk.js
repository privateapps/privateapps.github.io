(this["webpackJsonplife-log"]=this["webpackJsonplife-log"]||[]).push([[0],{16:function(e,t,n){},17:function(e,t,n){},19:function(e,t,n){"use strict";n.r(t);var i=n(0),s=n(2),a=n.n(s),c=n(5),o=n.n(c),l=n(6),r=n(7),d=n(8),m=n(3),u=n(10),h=n(9),j=(n(16),n(17),n(1)),f=n.n(j),b=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(r.a)(this,n),(e=t.call(this)).refreshList=function(){var t=[],n=Object(m.a)(e);f.a.iterate((function(e,n,i){t.push(e)})).then((function(){console.log("Iteration has completed");var e=t.sort((function(e,t){var n=new Date(e.timestamp).getTime();return new Date(t.timestamp).getTime()-n}));n.setState({items:e})})).catch((function(e){console.log(e)}))},e.handleListFilterChange=function(t){e.refreshList();var n=t.target.value;console.log("inputVal = ".concat(n));var i=e.state.items.filter((function(e){var t=JSON.stringify(e).toLowerCase();if(console.log(t),t.indexOf(n.toLowerCase())>-1)return e}));if(i.length>0){var s=Object(m.a)(e);setTimeout((function(){s.setState({items:i}),s.setState({filterText:n})}),1e3)}},e.handleItemClick=function(t){e.showItemDetails(t),g=t},e.handleDeleteItemClick=function(t){var n;t.preventDefault(),n=g,f.a.removeItem(n).then((function(){console.log("".concat(JSON.stringify(n)," deleted!")),p()})).catch((function(e){console.log(e)})),e.refreshList()},e.handleFormSubmit=function(t){t.preventDefault();var n=new Date,i={timestamp:n.toISOString(),description:e.state.description};!function(e,t){console.log("adding ".concat(JSON.stringify(t))),f.a.setItem(e,t).then((function(){return f.a.getItem("key")})).then((function(e){v("list-entries")})).catch((function(e){alert("adding item failed")}))}(n.getTime().toString(),i);var s=e.state.items.concat(i).sort((function(e,t){var n=new Date(e.timestamp).getTime();return new Date(t.timestamp).getTime()-n}));e.setState({items:s})},e.state={items:[],description:""},e.handleSearchButtonSubmit=e.handleSearchButtonSubmit.bind(Object(m.a)(e)),e.input=a.a.createRef(),e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){this.refreshList()}},{key:"handleFormChange",value:function(e,t){console.log(e,t.target.value),this.setState(Object(l.a)({},e,t.target.value))}},{key:"handleSearchButtonSubmit",value:function(e){var t=[],n=this,i=this.input.current.value;console.log("inputVal = ".concat(i)),f.a.iterate((function(e,n,s){JSON.stringify(e).toLowerCase().indexOf(i.toLowerCase())>-1&&t.push(e)})).then((function(){console.log("Iteration has completed");var e=t.sort((function(e,t){var n=new Date(e.timestamp).getTime();return new Date(t.timestamp).getTime()-n}));n.setState({items:e}),n.setState({filterText:i})})).catch((function(e){console.log(e)}))}},{key:"showItemDetails",value:function(e){var t=new Date(e.timestamp).getTime().toString();f.a.getItem(t).then((function(n){var i=n.description;document.getElementById("currentItemDesc").value=i;var s="".concat(new Date(e.timestamp).toLocaleString()," - ").concat(i);document.getElementById("currentItemSummary").innerHTML=s,g=t,document.getElementById("item-modal").classList.add("is-active")})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this;return Object(i.jsxs)("div",{className:"App",children:[Object(i.jsxs)("section",{className:"section",children:[Object(i.jsx)("div",{className:"content",children:Object(i.jsx)("h3",{className:"has-text-centered",children:"Life Log"})}),Object(i.jsx)("div",{className:"tabs is-centered",children:Object(i.jsxs)("ul",{children:[Object(i.jsx)("li",{id:"enter-data-list-item",className:"is-active",children:Object(i.jsx)("a",{onClick:function(e){return v("enter-data")},children:"Enter"})}),Object(i.jsx)("li",{id:"list-entries-list-item",children:Object(i.jsx)("a",{onClick:function(e){return v("list-entries")},children:"List"})})]})}),Object(i.jsx)("div",{id:"enter-data",className:"column",children:Object(i.jsx)("form",{onSubmit:this.handleFormSubmit,children:Object(i.jsxs)("div",{className:"columns is-gapless",children:[Object(i.jsx)("div",{className:"column"}),Object(i.jsxs)("div",{className:"column",children:[Object(i.jsxs)("div",{className:"field",children:[Object(i.jsx)("label",{className:"label",children:"Log stuff here:"}),Object(i.jsxs)("div",{className:"control has-icons-left",children:[Object(i.jsx)("textarea",{className:"textarea",type:"text",placeholder:"Put anything to describe what life event you want to track",defaultValue:"",onChange:this.handleFormChange.bind(this,"description")}),Object(i.jsx)("span",{className:"icon is-small is-left",children:Object(i.jsx)("i",{className:"fas fa-asterisk"})})]})]}),Object(i.jsxs)("div",{className:"field is-grouped",children:[Object(i.jsx)("p",{className:"control",children:Object(i.jsx)("a",{type:"submit",onClick:this.handleFormSubmit,className:"button is-success",children:"Add"})}),Object(i.jsx)("p",{className:"control",children:Object(i.jsx)("a",{className:"button is-danger",children:"Clear"})})]})]}),Object(i.jsx)("div",{className:"column"})]})})}),Object(i.jsxs)("div",{id:"list-entries",className:"column",style:{display:"none"},children:[Object(i.jsx)("form",{onSubmit:this.handleSearchButtonSubmit,children:Object(i.jsxs)("div",{className:"field has-addons",children:[Object(i.jsx)("div",{className:"control is-expanded",children:Object(i.jsx)("input",{className:"input",type:"text",placeholder:"Start typing here to filter",defaultValue:"",ref:this.input})}),Object(i.jsx)("div",{className:"control",children:Object(i.jsx)("a",{className:"button is-info",onClick:this.handleSearchButtonSubmit,children:"Search"})})]})}),Object(i.jsxs)("table",{id:"entry-items",className:"table",children:[Object(i.jsx)("thead",{children:Object(i.jsxs)("tr",{children:[Object(i.jsx)("th",{children:"Date"}),Object(i.jsx)("th",{children:"Description"})]})}),Object(i.jsx)("tbody",{children:this.state.items&&this.state.items.map((function(t){return Object(i.jsxs)("tr",{onClick:function(n){return e.handleItemClick(t,n)},children:[Object(i.jsx)("td",{children:new Date(t.timestamp).toLocaleString()}),Object(i.jsx)("td",{children:t.description})]},new Date(t.timestamp).getTime())}))})]}),Object(i.jsxs)("div",{className:"field is-grouped",children:[Object(i.jsx)("p",{className:"control",children:Object(i.jsx)("button",{onClick:x,className:"button is-info",children:"Download Data"})}),Object(i.jsxs)("p",{className:"control",children:[Object(i.jsx)("input",{type:"file",id:"importFile",style:{display:"none"},onChange:y}),Object(i.jsx)("button",{className:"button is-success",children:Object(i.jsx)("label",{htmlFor:"importFile",children:"Import Data"})})]})]})]})]}),Object(i.jsxs)("div",{id:"item-modal",className:"modal",children:[Object(i.jsx)("div",{className:"modal-background"}),Object(i.jsxs)("div",{className:"modal-card",children:[Object(i.jsxs)("header",{className:"modal-card-head",children:[Object(i.jsx)("p",{className:"modal-card-title",children:"Item Details"}),Object(i.jsx)("button",{className:"delete","aria-label":"close",onClick:p})]}),Object(i.jsxs)("section",{className:"modal-card-body",children:[Object(i.jsx)("table",{className:"table",children:Object(i.jsx)("tbody",{children:Object(i.jsxs)("tr",{children:[Object(i.jsx)("td",{children:"Life Event:"}),Object(i.jsx)("td",{children:Object(i.jsx)("textarea",{id:"currentItemDesc",className:"textarea",type:"text"})})]})})}),Object(i.jsx)("div",{id:"currentItemSummary"})]}),Object(i.jsxs)("footer",{className:"modal-card-foot",children:[Object(i.jsx)("button",{className:"button is-success",children:"Save"}),Object(i.jsx)("button",{onClick:this.handleDeleteItemClick,className:"button is-danger",children:"Delete"}),Object(i.jsx)("button",{onClick:O,className:"button is-info",children:"Share"})]})]})]})]})}}]),n}(s.Component),g="";function v(e){"enter-data"===e?(document.getElementById("enter-data").style.display="block",document.getElementById("list-entries").style.display="none",document.getElementById("enter-data-list-item").classList.add("is-active"),document.getElementById("list-entries-list-item").classList.remove("is-active")):"list-entries"===e&&(document.getElementById("enter-data").style.display="none",document.getElementById("list-entries").style.display="block",document.getElementById("enter-data-list-item").classList.remove("is-active"),document.getElementById("list-entries-list-item").classList.add("is-active")),document.getElementById(e).style.display="block"}function p(){g="",document.getElementById("item-modal").classList.remove("is-active")}function O(){console.log("Share button clicked! Let's see if anything else happens.");var e=document.getElementById("currentItemSummary").innerHTML||"Sorry, your browser and/or phone doesn't allow sharing.";navigator.share?(console.log("Share is allowed. Yay! Will now try to share ".concat(e)),navigator.share({title:"Life Log Item",text:e}).then((function(){console.log("Successful share")})).catch((function(e){alert("Error sharing",e)}))):alert("Sorry, this only works on Android Chrome.")}function x(){console.log("Export button clicked! Let's see if anything else happens.");var e=[];f.a.iterate((function(t,n,i){e.push(t)})).then((function(){console.log("Iteration has completed");var t=JSON.stringify(e);console.log("downloading as json = ".concat(t));var n="data:text/json;charset=utf-8,"+encodeURIComponent(t),i=document.createElement("a");i.setAttribute("href",n),i.setAttribute("download","life-log-backup.json"),i.click(),i.remove()})).catch((function(e){console.log(e)}))}function y(){var e=document.getElementById("importFile").files[0],t=new FileReader;t.readAsText(e),t.onload=function(e){for(var t=JSON.parse(e.target.result),n=0,i=t.length,s=function(){var e=t[n],i=new Date(e.timestamp).getTime().toString();f.a.setItem(i,e).then((function(){return f.a.getItem("key")})).then((function(t){console.log("".concat(JSON.stringify(e),"\n"))})).catch((function(e){alert("adding item failed")}))};n<i;n++)s();alert("Importing data done!")}}f.a.config({driver:f.a.INDEXEDDB,name:"life-log",version:1,size:4980736,storeName:"life_log",description:"life log"});var N=b,w=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function S(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(Object(i.jsx)(N,{}),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/life-log",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/life-log","/service-worker.js");w?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):S(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):S(e)}))}}()}},[[19,1,2]]]);
//# sourceMappingURL=main.486c56a8.chunk.js.map